# Организация файловой структуры БЭМ-проекта

БЭМ-методология также как и Web Componets использует компонентный подход. В файловой системе это выражается разделением блоков на отдельные директории, которые содержат всю информацию о блоке.

//В основе БЭМ-методологии лежит компонентный подход. БЭМ делит интерфейс на независимые блоки (аналогия Web Componnets). Компонентный подход диктует правила организации файловой системы БЭМ-проектов.

* [Принципы организации файловой системы БЭМ-проекта](#principles)
* [Сборка проекта](#build)
* [Уровни переопределения](#level)
* [Примеры из жизни](#examples)
* [Альтернативные схемы организации файловой системы](#alternate)

<a name="principles"></a>
## Принципы организации файловой системы БЭМ-проекта

Каждому блоку соответствует отдельная директория. Имена блока и его директории совпадают. Все блоки хранятся плоским списком независимо от их представления в интерфейсе.

//Блок — независимый компонент страницы и отдельная директория в файловой системе. Имена блока и его директории совпадают. Все блоки хранятся плоским списком независимо от их представления в интерфейсе.

```
blocks/
├── block1/     # Папка блока block1
└── block2/
```

Директория блока содержит [технологии реализации](../definitions/definitions.ru.md#techs), которые хранятся в отдельных файлах с соответствующими расширениями — **файлах технологий**. Имена файлов совпадают с именем блока.

```
blocks/
├── block1/
|   ├── block1.css       # Файл технологии CSS
|   ├── block1.js        # Файл технологии JavaScript
|   └── block1.bemhtml   # Файл технологии BEMHTML
└── block2/
    ├── block2.css
    ├── block2.js
    ├── block2.bemhtml
    └── block2.png
```
Для каждого элемента и модификатора создаются отдельные файлы технологий в директории блока.

Имена файлов соответствуют схеме:

* Элемент — `block__elem`
* Модификатор блока — `block_mod_val`.
* Модификатор элемента — `block__elem_mod_val`.


```
blocks/
├── block1/
|   ├── block1_mod_val.css       # Файл модификатора в технологии CSS
|   ├── block1_mod_val.bemhtml   # Файл модификатора технологии BEMHTML
|   ├── block1__elem.css         # Файл элемента в технологии CSS
|   ├── block1__elem.js          # Файл элемента в технологии JavaScript
|   ├── block1__elem.bemhtml     # Файл элемента в технологии BEMHTML
|   ├── block1.css
|   ├── block1.js
|   └── block1.bemhtml
└── block2/
    ├── block2.css
    ├── block2.js
    ├── block2.bemhtml
    └── block2.png
```

Если использование элемента или модификатора опционально, для каждого из них создаются отдельные поддиректории с файлами технологий. В именах поддиректорий имя блока не указывается.

```
blocks/
├── block1/
|   ├── _mod1/                        # Папка модификатора block1_mod1
|       ├── block1_mod1_val.css
|       └── block1_mod1_val.bemhtml
|   ├── __elem1/                      # Папка элемента block1__elem1
|       ├── block1__elem1.js
|       ├── block1__elem1.css
|       └── block1__elem1.bemhtml
|   ├── block1.css
|   ├── block1.js
|   └── block1.bemhtml
└── block2/
    ├── block2.css
    ├── block2.js
    ├── block2.bemhtml
    └── block2.png
```
<a name="build"></a>
### Сборка проекта

<a name="benefits"></a>
Файловая система БЭМ-проекта устроена таким образом, чтобы разработчик писал код отдельно для каждого блока. Такая организация проекта позволяет:

* Разделять код на человеко- и машиночитаемый.
* Повторно использовать блоки в разных проектах.
* Вносить изменения точечно в каждый отдельный файл технологии.
* Быстро находить необходимые файлы.
* Подключать в сборку только требуемые для страницы/бандла файлы.

В отличие от человека, браузер не может эффективно работать с большим набором файлов и директорий. Поэтому в БЭМ-проекте используется [сборка](../sborka): перед тем, как отдать код браузеру, файлы собираются и оптимизируются.

<a name="level"></a>
## Уровни переопределения

В БЭМ-проекте существуют понятие [уровня переопределения](../definitions/definitions.ru.md#level).

Уровень переопределения позволяет переопределять и доопределять блоки в проекте без дублирования кода.
В файловой системе уровень — это плоский список директорий блоков. Все блоки БЭМ-проекта разложены по уровням.

```
common/         # Уровень переопределения common
├── block1/
└── block2/
desktop/        # Уровень переопределения desktop
├── block1/     # Переопределение блока block1
└── block3/
```

Рассмотрим пример. В проекте существует два уровня переопределения `common` и `desktop`. Уровень `common` содержит базовую реализацию блоков. На уровне `desktop` хранится специфические особенности, характерные для desktop-платформ.

```
common.blocks/
├── button/
    └── button.css    # Базовая CSS-реализация кнопки (высота 20px)
desktop.blocks/
└── button/
    └── button.css    # Переопределение CSS-реализации кнопки (высота 24px)
```

При сборке в файл `desktop.css` попадут все базовые CSS-правила кнопи с уровня `common` и переопределенные парвила с уровня `desktop`.

```
@import(common.blocks/button/button.css);    # Базовые CSS-правила
@import(desktop.blocks/button/button.css);   # Переопределенная высота кнопки
```

### Зачем нужны уровни переопределения

Уровни переопределения позволяют:

**Переопределять и доопределять блоки готовых библиотек**

* В БЭМ-проект библиотека подключается на отдельный уровень. Переопределенные блоки хранятся на другом уровне. При сборке проекта применятся исходная функциональность с уровня библиотеки и переопределенная — с уровня проекта. Такое разделение позволяет сохранить переопределенные файлы при обновлении библиотеки. Код самой библиотеки обновится, а специфическая реализация блоков проекта останется прежней.

**Отказаться от дублирования кода**

* Переопределение блока не требует копирования кода блока на новый уровень. Достаточно создать только переопределяемый файл технологии. При сборке он перекроет базовую функциональность, которую необходимо изменить.
* Реализация БЭМ-проекта может быть разделена на платформы (`mobile`, `touch`, `desktop`). При этом базовая реализация блоков для всех платформ выносится на отдельный уровень. В сборку для каждой платформы попадут файлы только с требуемых уровней.
* Общие блоки для разных проектов могут быть вынесены на отдельный уровень (Х) и подключаться в проекты при сборке. В таком случае изменение базовой функциональности таких блоков потребует правок только на уровне Х. При сборке изменения подключатся в проекты автоматически.

<a name="examples"></a>
## Примеры из жизни

* [bem-core](https://ru.bem.info/libs/bem-core/current/)
* [bem-components](https://ru.bem.info/libs/bem-components/current/)

Использование описанной структуры организации файловой системы не является требованием БЭМ-методологии. Существуют [альтернативные](#alternate) варианты организации файловой системы БЭМ-проектов.

<a name="alternate"></a>
## Альтернативные схемы организации файловой системы

БЭМ-методология поддерживает различные варианты организации файловой структуры блока. Важно придерживаться единообразия в пределах проекта. Не все перечисленные альтернативные схемы организации проекта совместимы. Только описанная выше структура дает полный набор [преимуществ](#benefits) при сборке проекта.

### Каждый блок в директории, элементы и модификаторы в отдельных файлах без директорий
```
blocks/
    b-menu/
        b-menu_layout_horiz.css
        b-menu_layout_horiz.bemhtml
        b-menu_layout_vertical.css
        b-menu_layout_vertical.bemhtml
        b-menu__elem.css
        b-menu__elem.bemhtml
        b-menu.css
        b-menu.js
        b-menu.bemhtml
```
### Каждый блок в директории, элементы и модификаторы в файлах блока
```
blocks/
    b-menu/
        b-menu.css
        b-menu.js
        b-menu.bemhtml
```
### Директории не используются, элементы и модификаторы в отдельных файлах
```
blocks/
    b-menu_layout_horiz.css
    b-menu_layout_horiz.bemhtml
    b-menu_layout_vertical.css
    b-menu_layout_vertical.bemhtml
    b-menu__elem.css
    b-menu__elem.bemhtml
    b-menu.css
    b-menu.js
    b-menu.bemhtml
```

### Директории не используются, элементы и модификаторы в файлах блока
```
blocks/
    b-menu.css
    b-menu.js
    b-menu.bemhtml
```
