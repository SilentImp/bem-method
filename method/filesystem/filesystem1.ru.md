Принципы организации файловой системы БЭМ-проекта основываются на разделении проекта на независимые блоки для решения следующих задач:

* повторное использование кода;
* ускорение отладки проекта;
* создание самодокументироуемеого кода;
* сборка только нужных данных.

Решение перечисленных задач практически невозможно при использовании стандартных методов создания сайтов, когда весь CSS-код пишется в одном файле, а JavaScript — в другом.

Структура стандартного веб-проекта:
```
css/
    my-project.css
js/
    my-project.js
images/
    1.png
    2.png
    3.png
```

## Принципы организации файловой системы классического БЭМ-проекта

Проект разделяется на [уровни переопределения](../definitions/definitions.ru.md#level) (уровни). Каждый уровень содержит набор БЭМ-сущностей, расположенных в директориях блоков.

```
level1/     # Уровень переопределения 1
level2/
```
Каждому блоку соответствует отдельная директория. Имя блока и его директории совпадают.

```
level1/
├── block1/     # Папка блока block1
└── block2/
level2/
├── block1/
└── block3/
```
Директория блока содержит реализацию блока, которая делится на отдельные технологии (CSS, JS, txt, BEMHTML и т.д.). Технологии реализации хранятся в отдельных файлах с соответствующими расширениями — **файлах технологий**. Имя файла технологии совпадает с именем блока.

```
level1/
├── block1/
|   ├── block1.css       # Файл технологии CSS
|   ├── block1.js        # Файл технологии JavaScript
|   └── block1.bemhtml   # Файл технологии BEMHTML
└── block2/
    ├── block2.css
    ├── block2.js
    ├── block2.bemhtml
    └── block2.png
```
Для каждого элемента создаются отдельные поддиректории с файлами технологий. Имя директории элемента начинается с двух подчеркиваний и совпадает с именем элемента.

```
level1/
├── block1/
|   ├── __elem1/     # Папка элемента block1__elem1
|   |   ├── block1__elem1.js
|   |   └── block1__elem1.bemhtml
|   ├── block1.css
|   ├── block1.js
|   └── block1.bemhtml
└── block2/
    ├── block2.css
    ├── block2.js
    ├── block2.bemhtml
    └── block2.png
```
Для каждого модификатора создаются отдельные поддиректории с файлами технологий. Имя директории модификатора начинается с одного подчеркивания и совпадает с именем модификатора. Имя файла технологий содержит значения модификатора.

```
level1/
├── block1/
|   ├── _mod1/      # Папка модификатора block1_mod1
|   |   └── block1_mod1_value.css
|   ├── __elem1/
|   |   ├── block1__elem1.js
|   |   ├── block1__elem1.bemhtml
|   |   └── _mod3/
|   |       └── block1_mod3_value.css
|   ├── __elem2/
|   ├── block1.css
|   ├── block1.js
|   └── block1.bemhtml
└── block2/
    ├── block2.css
    ├── block2.js
    ├── block2.bemhtml
    └── block2.png
```
Использование классической структуры организации файловой системы не является требованием БЭМ-методологии. Существуют [альтернативные](#alternate) варианты организации файловой системы БЭМ-проектов.

<a name="levels"></a>
### Зачем нужны уровни переопределения

[Уровень переопределения](../definitions/definitions.ru.md#level) — это набор директорий блоков с их полными или частичными реализациями.

**Пример**

Допустим, веб-проект должен поддерживать мобильные платформы. Логика поведения некоторых компонентов интерфейса на десктопных и мобильных платформах отличается. Например, кнопка на десктопе может реагировать на наведение курсором, а в мобильной версии эта функциональность отсутсвует. Также размеры кнопки на разных платформах отличаются. Распределим реализацию блока по уровням переопределения. В файловой системе структрура проекта будет выглядеть так:

```
common/           # Общее поведение и внешний вид блока button
└── button/
    ├── _theme/
        └── button_theme_orange.css
    ├── _size/
        ├── button_size_x-small.css
        └── button_size_small.css
    ├── button.js
    └── button.behtml
desktop/           # Специфическая реализация блока button для desktop-платформ
└── button/
    ├── _hovered/  # Добавлен модификатор _hovered
        ├── button_hovered_true.js
        ├── button_hovered_true.bemhtml
        └── button_hovered_true.css
touch/             # Специфическая реализация блока button для touch-платформ
└── button/
    └── _size/     # Изменен размер блока button
        └── button_size_large.css
```

В сборку для каждой платформы попадет общие данные из уровня `common`. А специфическое поведение и внешний вид для каждой платформы будет собран отдельно с уровня `desktop` и `touch`.

**Какие задачи решают**

* Сборка только нужных файлов<br>
Проект может содержать любое количество реализаций блоков. Но при сборке на страницу попадут только те, что явно указаны в [декларации](#decl) страницы. Возможно задавать разные наборы уровней переопределения для разных разделов сайтов.

* Проект без дублирования кода<br>
Общие блоки для нескольких сайтов портала можно выделить в библиотеку и разместить ее на отдельном уровне переопределения. Специфические блоки и модификации общих блоков можно хранить на уровне переопределения каждого конкретного сайта. По такому же принципу можно подключать сторонние библиотеки в проект и обновлять их с минимальными корректировками в конечном коде проекта.

* Разделение по платформам<br>
В одном и том же репозитории может храниться реализация сайта для десктопных и мобильных браузеров. Общая реализация бля всех платфори также выносится на отдельный уровень. Различные комбинации уровней дают желаемую реализацию блоков.

* Разделение зон ответственности<br>
Разработка проекта может вестись параллельно на разных уровнях переопределения.

## Работа с файловой системой

Разделение кода проекта на уровни, директории блоков и файлы технологий порождает несколько потенциальных проблем:

* Обработка большого количества мелких файлов браузером требует больше времени, чем обрабока одного файла, содержащего все сущности для работы.
* Возникает необходимость отслеживать вручную добавление и удаление БЭМ-сущностей проекта.

Решением этих проблем является [сборка](ссылка на док про сборку) проекта. Любой БЭМ-проект  Автомотизировать сборку и решить проблему с отслеживанием добавленного и удаленного кода помогает использование [декларации страницы](#decl) и [уровней переопределения](#levels).

<a name="decl"></a>
### Декларация страницы

**Декларация страницы** — это список БЭМ-сущностей, которые должны попасть в проект при сборке. Обычно такой список в БЭМ-проектах описывается в формате BEMDECL или BEMJSON.

Декларация может создаваться как [вручную](#manual-decl), так и [автоматически](#auto-decl) на основе [BEMJSON](https://ru.bem.info/technology/bemjson/current/bemjson/)-описания страницы.

<a name="manual-decl"></a>
Пример декларации, созданной вручную (BEMDECL).

```
exports.blocks = [
    { name: 'input' },
    { name: 'button' },
    { name: 'checkbox' }
];
```

<a name="auto-decl"></a>
При разработке веб-проекта страницы чаще всего описывают в формате BEMJSON, а декларация сборки в формате BEMDECL формируется автоматически.

В конфигурационном файле сборщика указываются все уровни переопределения, необходимые для сборки. Сборщик обрабатывает данные из BEMJSON-описания страницы, учитывает информацию о зависимостях и получает исходный набор БЭМ-сущностей, необходимых для сборки страницы — декларацию сборки (BEMDECL). На основе декларации страницы и знании об уровнях переопределения, указанных в конфигурационном файле сборщика, создается оптимизированный файл, содержащий все БЭМ-сущности для работы страницы.

### Зачем разделять проект на части и использовать сборку

Основная идея схожа с принципами ООП — иметь возможность создать ограниченное число повторно используемых компонентов, которые могут изменяться в зависимости от расположения по уровням и конфигурации сборки. Такой подход позволяет создавать более надежные, гибкие и пригодные для повторного использования компоненты.

* Разделение на человеко- и машиночитаемый код <br>
В файловой системе хранится исходный код проекта, понятный для человека. Такой код легко поддерживать, находить нужные БЭМ-сущности, вносить точечные изменения. В браузер отдается код, преобразованный сборщиком — собранный в файлы по технологиям и оптимизированный.

* Сборка только нужных данных
Проект может содержать разные уровни переопределения, созданные для разных целей. При сборке для каждого частного случая используются только необходимые БЭМ-сущности, описанные в декларации сборки и собранные с указанных уровней переопределения.

* Повторное использование кода
Блоки проекта подключается в сборку на основе декларации один раз и применяется в нужном количестве при отрисовке страницы.

<a name="alternate"></a>
## Альтернативные варианты структуры блока в файловой системе

### Каждый блок в директории, элементы и модификаторы в отдельных файлах без директорий
```
blocks/
    b-menu/
        b-menu_layout_horiz.css
        b-menu_layout_horiz.bemhtml
        b-menu_layout_vertical.css
        b-menu_layout_vertical.bemhtml
        b-menu__elem.css
        b-menu__elem.bemhtml
        b-menu.css
        b-menu.js
        b-menu.bemhtml
```
### Каждый блок в директории, элементы и модификаторы в файлах блока
```
blocks/
    b-menu/
        b-menu.css
        b-menu.js
        b-menu.bemhtml
```
### Директории не используются, элементы и модификаторы в отдельных файлах
```
blocks/
    b-menu_layout_horiz.css
    b-menu_layout_horiz.bemhtml
    b-menu_layout_vertical.css
    b-menu_layout_vertical.bemhtml
    b-menu__elem.css
    b-menu__elem.bemhtml
    b-menu.css
    b-menu.js
    b-menu.bemhtml
```

### Директории не используются, элементы и модификаторы в файлах блока
```
blocks/
    b-menu.css
    b-menu.js
    b-menu.bemhtml
```
